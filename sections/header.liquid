{% comment %}
  Dynamic header drawer with image and text dropdowns for Shopify Dawn theme.
  Preserves original design while making menu dynamic.
{% endcomment %}

<header-drawer data-breakpoint="{{ section.settings.menu_type_desktop | default: 'tablet' }}">
  <details id="Details-menu-drawer-container" class="menu-drawer-container">
    <summary
      class="header__icon header__icon--menu header__icon--summary link focus-inset"
      aria-label="{{ 'sections.header.menu' | t }}"
    >
      <span>
        {{ 'icon-hamburger.svg' | inline_asset_content }}
        {{ 'icon-close.svg' | inline_asset_content }}
      </span>
    </summary>
    <div id="menu-drawer" class="gradient menu-drawer motion-reduce color-{{ section.settings.menu_color_scheme }}">
      <div class="menu-drawer__inner-container">
        <nav class="menu-drawer__navigation">
          <ul class="menu-drawer__menu list-menu" role="list">
            {% for link in linklists['main-menu'].links %}
              <li class="group relative">
                <a href="{{ link.url }}" class="px-4 py-2 inline-block">{{ link.title }}</a>
                {% if link.links != blank %}
                  <div class="absolute left-0 w-full bg-white shadow-lg hidden group-hover:flex">
                    <div class="max-w-screen-xl mx-auto grid grid-cols-2 gap-4 p-4">
                      {% for childlink in link.links %}
                        <div class="relative overflow-hidden">
                          <img
                            src="{{ childlink.image | default: 'https://via.placeholder.com/400' }}"
                            alt="{{ childlink.title }}"
                            class="w-full h-full object-cover"
                          >
                          <div class="absolute inset-0 bg-black bg-opacity-30 flex flex-col justify-center items-center text-white">
                            <h3 class="text-2xl font-semibold">{{ childlink.title }}</h3>
                            <a href="{{ childlink.url }}" class="mt-2 bg-white text-black px-4 py-2 rounded-full"
                              >Discover now</a
                            >
                          </div>
                        </div>
                      {% endfor %}
                    </div>
                  </div>
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        </nav>
        {% if localization.available_countries.size > 1 %}
          <localization-form>
            <form action="/localization" method="post" class="localization-form">
              <select name="country" onchange="this.form.submit()">
                {% for country in localization.available_countries %}
                  <option
                    value="{{ country.iso_code }}"
                    {% if country.iso_code == localization.country.iso_code %}
                      selected
                    {% endif %}
                  >
                    {{ country.name }}
                  </option>
                {% endfor %}
              </select>
            </form>
          </localization-form>
        {% endif %}
      </div>
    </div>
  </details>
</header-drawer>
