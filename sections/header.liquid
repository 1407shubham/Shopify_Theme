{% comment %}
  Dynamic header drawer menu for Shopify Dawn theme.
  Fetches navigation links and includes localization (country switcher).
{% endcomment %}

<header-drawer data-breakpoint="{{ section.settings.menu_type_desktop | default: 'tablet' }}">
  <details id="Details-menu-drawer-container" class="menu-drawer-container">
    <summary
      class="header__icon header__icon--menu header__icon--summary link focus-inset"
      aria-label="{{ 'sections.header.menu' | t }}"
    >
      <span>
        {{ 'icon-hamburger.svg' | inline_asset_content }}
        {{ 'icon-close.svg' | inline_asset_content }}
      </span>
    </summary>
    <div id="menu-drawer" class="gradient menu-drawer motion-reduce color-{{ section.settings.menu_color_scheme }}">
      <div class="menu-drawer__inner-container">
        <nav class="menu-drawer__navigation">
          <ul class="menu-drawer__menu list-menu" role="list">
            {% for link in linklists['main-menu'].links %}
              <li>
                {% if link.links != blank %}
                  <details>
                    <summary class="menu-drawer__menu-item link link--text">{{ link.title }}</summary>
                    <ul class="menu-drawer__submenu list-menu">
                      {% for childlink in link.links %}
                        <li>
                          <a href="{{ childlink.url }}" class="link link--text">{{ childlink.title }}</a>
                        </li>
                      {% endfor %}
                    </ul>
                  </details>
                {% else %}
                  <a href="{{ link.url }}" class="menu-drawer__menu-item link link--text">{{ link.title }}</a>
                {% endif %}
              </li>
            {% endfor %}
          </ul>
        </nav>
        {% if localization.available_countries.size > 1 %}
          <localization-form>
            <form action="/localization" method="post" class="localization-form">
              <select name="country" onchange="this.form.submit()">
                {% for country in localization.available_countries %}
                  <option
                    value="{{ country.iso_code }}"
                    {% if country.iso_code == localization.country.iso_code %}
                      selected
                    {% endif %}
                  >
                    {{ country.name }}
                  </option>
                {% endfor %}
              </select>
            </form>
          </localization-form>
        {% endif %}
      </div>
    </div>
  </details>
</header-drawer>
